{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    "config:recommended",
    ":maintainLockFilesWeekly",
    "helpers:pinGitHubActionDigests",
  ],

  // Exclude `examples` from "config:recommended"
  "ignorePaths": [
    "**/node_modules/**",
    "**/bower_components/**",
    "**/vendor/**",
    // "**/examples/**",
    "**/__tests__/**",
    "**/test/**",
    "**/tests/**",
    "**/__fixtures__/**",
  ],

  "enabledManagers": [
    "cargo",
    "custom.regex",
    "github-actions",
    "npm",
    "nvm",
  ],

  "labels": ["bot:renovate"],

  "packageRules": [
    {
      "matchPackageNames": [
        "*",
      ],
      "rangeStrategy": "bump",
    },
    {
      "groupName": "Rspack",
      "groupSlug": "Rspack",
      "addLabels": ["upstream:rspack"],
      "matchDepTypes": [
        "devDependencies",
        "dependencies",
      ],
      "matchPackageNames": [
        "/@rspack/*/",
      ],
      "rangeStrategy": "pin",
    },
    {
      "groupName": "Rsbuild",
      "groupSlug": "Rsbuild",
      "addLabels": ["upstream:rspack"],
      "matchDepTypes": [
        "devDependencies",
        "dependencies",
      ],
      "matchPackageNames": [
        "/@rsbuild/*/",
        "/rsbuild-plugin-*/",
      ],
      "rangeStrategy": "pin",
    },
    {
      "groupName": "Rspress",
      "groupSlug": "Rspress",
      "matchDepTypes": [
        "devDependencies",
        "dependencies",
      ],
      "matchPackageNames": [
        "rspress",
        "/@rspress/*/",
        "@rstack-dev/doc-ui",
        "/@shikijs/*/",
      ],
      "rangeStrategy": "pin",
    },
    {
      "groupName": "changesets",
      "groupSlug": "changesets",
      "matchPackageNames": [
        "/^@changesets/*/",
      ],
    },
    {
      "groupName": "Prefresh",
      "groupSlug": "prefresh",
      "matchPackageNames": [
        "/@prefresh/*/"
      ]
    },
    {
      "groupName": "API Extractor",
      "groupSlug": "api-extractor",
      "matchPackageNames": [
        "@microsoft/api-documenter",
        "@microsoft/api-extractor",
        "@microsoft/api-extractor-model",
        "@microsoft/tsdoc",
      ],
    },
    {
      "groupName": "linting",
      "groupSlug": "linting",
      "matchPackageNames": [
        "/eslint/",
        "globals",
        "husky",
        "lint-staged",
        "sort-package-json",
      ],
    },
    {
      "groupName": "Typia",
      "groupSlug": "typia",
      "matchPackageNames": [
        "typia",
        "typia-rspack-plugin",
        "@samchon/openapi",
      ],
      "rangeStrategy": "pin",
    },
    {
      "matchDepTypes": [
        "peerDependencies",
      ],
      "rangeStrategy": "widen",
    },
    {
      "groupName": "github-actions",
      "groupSlug": "github-actions",
      "matchManagers": ["github-actions"],
    },
    {
      "groupName": "types",
      "groupSlug": "types",
      "matchPackageNames": [
        "/^@tsconfig/*/",
        "/^@types/*/",
      ],
    },
    {
      "groupName": "Lynx Engine",
      "groupSlug": "lynx-engine",
      "matchManagers": ["custom.regex"],
      "matchPackageNames": [
        "https://github.com/lynx-family/lynx",
      ],
      // Schedule once a month on the first day of the month before 4 AM.
      "schedule": [
        "* 0-3 1 * *",
      ],
    },
        {
      "groupName": "Rust Crates",
      "groupSlug": "rust-crates",
      "matchManagers": ["cargo"],
      "matchPackageNames": [
        "!swc",
        "!swc_*",
      ],
    },
    {
      "groupName": "SWC",
      "groupSlug": "swc",
      "matchManagers": ["cargo"],
      "matchPackageNames": [
        "swc",
        "swc_*",
      ],
      "matchUpdateTypes": [
        "major",
      ],
    },
    {
      "extends": [
        "monorepo:playwright",
      ],
      "groupName": "playwright monorepo",
      "matchPackageNames": [
        "playwright",
        "@playwright/**",
      ],
    },
    {
      "groupName": "playwright monorepo",
      "matchPackageNames": [
        "mcr.microsoft.com/playwright",
      ],
      "versioning": "regex:^v(?<major>\\d+)\\.(?<minor>\\d+)\\.(?<patch>\\d+)-noble$",
    },
  ],

  "customManagers": [
    {
      // Update benchx_cli version from GitHub releases
      // See: https://docs.renovatebot.com/modules/datasource/github-releases/
      "customType": "regex",
      "managerFilePatterns": ["packages/lynx/benchx_cli/scripts/build.sh"],
      "matchStrings": ["LOCKED_VERSION=\"(?<currentValue>benchx_cli-.*?)\""],
      "depNameTemplate": "lynx-community/benchx_cli",
      "datasourceTemplate": "github-releases",
      "versioningTemplate": "regex:^benchx_cli-(?<major>\\d{4})(?<minor>\\d{2})(?<patch>\\d{2})(?<build>\\d{4})$",
    },
    {
      "customType": "regex",
      "managerFilePatterns": [".github/workflows/*"],
      "matchStrings": [
        "'(?<packageName>mcr\\.microsoft\\.com/playwright):(?<currentValue>[^\\s]+)'"
      ],
      "datasourceTemplate": "docker",
    },
  ],

  "postUpdateOptions": [
    "pnpmDedupe",
  ],
  "ignoreDeps": [
    // align Node.js version minimum requirements
    "node",

    // Rspress not compatible
    "@microsoft/api-documenter",

    // Not following SemVer
    "stormslowly/rust-cache",

    // Too many breaking change in 1.5.7. Manually upgrade later.
    "@rspack/test-tools",

    // Need update dotslash
    // See comments in packages/web-platform/web-style-transformer/scripts/wasm-bindgen
    "wasm-bindgen",

    // TODO: remove this after drop napi-rs
    "@emnapi/core",
    "@emnapi/runtime",
    "@napi-rs/cli",
    "napi",
    "napi-derive",
  ],
}
