/*
// Copyright 2023 The Lynx Authors. All rights reserved.
// Licensed under the Apache License Version 2.0 that can be found in the
// LICENSE file in the root directory of this source tree.
*/

/* Root container styles */
lynx-view {
  contain: strict;
  display: flex;
  position: relative;
  box-sizing: border-box;
  min-height: 0; /* Prevents flex content overflow */
}

/* Root part styles with improved layout handling */
lynx-view::part(lynx-view-root) {
  display: contents;
  width: 100%;
  height: 100%;
  isolation: isolate; /* Creates stacking context */
}

/* Auto height handling with modern logical properties */
lynx-view[height="auto"] {
  --lynx-view-height: 100%;
  height: var(--lynx-view-height);
  block-size: var(--lynx-view-height);
  min-block-size: 0;
  max-block-size: 100vh;
}
lynx-view[height="auto"]::part(lynx-view-root) {
  height: unset;
}

/* Auto width handling with modern logical properties */
lynx-view[width="auto"] {
  --lynx-view-width: 100%;
  width: var(--lynx-view-width);
  inline-size: var(--lynx-view-width);
  min-inline-size: 0;
  max-inline-size: 100vw;
}
lynx-view[width="auto"]::part(lynx-view-root) {
  width: unset;
}

/* Improved auto-sizing behaviors */
lynx-view[height="auto"], lynx-view[width="auto"] {
  contain-intrinsic-size: var(--lynx-view-width) var(--lynx-view-height);
  contain: size layout style paint;
}

/* Fixed positioning with improved stacking context */
lynx-view[height="auto"]::part(lynx-view-root),
lynx-view[width="auto"]::part(lynx-view-root) {
  display: unset;
  position: fixed;
  inset: 0; /* Replace top/left with logical inset */
  z-index: 1; /* Explicit stacking context */
}

/* CSS Custom Properties with improved syntax */
@property --lynx-view-width {
  syntax: "<length> | <percentage>";
  inherits: false;
  initial-value: 100%;
}

@property --lynx-view-height {
  syntax: "<length> | <percentage>";
  inherits: false;
  initial-value: 100%;
}

/* Default page part sizing */
lynx-view:not([width="auto"]):not([height="auto"])::part(page) {
  height: 100%;
  width: 100%;
  contain: content; /* Improve performance */
}

/* Add support for reduced motion */
@media (prefers-reduced-motion: reduce) {
  lynx-view {
    transition: none !important;
  }
}

/* Add support for color schemes */
@media (prefers-color-scheme: dark) {
  lynx-view {
    color-scheme: dark;
  }
}
